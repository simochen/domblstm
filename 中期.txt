一、搭建数据集1. 利用PISCES从PDB数据库中筛选相似度小于25%，分辨率小于3.0Å，R因子小于1.0的非冗余蛋白质序列集，包括12283条蛋白质序列。2. 从上述蛋白质序列集中滤除长度小于80个残基的序列，余下11153条蛋白质序列。3. 在蛋白质结构域数据库CATH4.0中搜索上述蛋白质，得到4999条蛋白质序列以及对应的6736条结构域序列。4. 将蛋白质以及结构域序列按照结构域的类型进行划分，分为单域、多域（不含不连续域，以下简称多域）、多域（含有不连续域，以下简称不连续域）三类。同时，滤除在CATH数据库中没有完整标注的部分序列。5. 最终得到包括3100条单域蛋白质序列，720条多域蛋白质序列，以及595条不连续域蛋白质序列的数据集，分别对应3100、1595、1380条结构域序列。二、编码目标输出1. 匹配结构域在蛋白质全序列中的位置。由于CATH中的结构域序列在PDB蛋白质序列上并非完全匹配，可能存在部分残基的插入、缺失和替换。故在进行两者序列的匹配时要考虑一定的编辑次数。考虑采用动态规划求取编辑距离和最长公共子序列的思想进行序列匹配，同时引入最大连续编辑次数的限制，并且记录子序列的起始与结束位置。最终得到结构域在蛋白质全序列中的位置。利用覆盖率（Overlap）对匹配的结果进行验证，得到大部分的序列都达到90%甚至95%以上的覆盖率。2. 编码得到预测模型的目标输出值。将结构域区域编码为0，域边界区域编码为1，考虑到域边界区域往往较小，对其进行两侧各5个残基的扩展。三、特征提取与编码1. 利用PSI-BLAST生成位置特异性打分矩阵（PSSM）。2. 利用 SCRATCH 预测二级结构和相对可溶解性信息。3. 利用 DISOPRED 预测序列的不规则信息4. 对上述特征进行编码。对于序列中的每个氨基酸残基，编码20维PSSM特征、3维二级结构特征、1维相对可溶解性特征以及1维disorder特征，得到25维特征向量。四、设计预测模型    采用双向循环神经网络（Bidirectional RNN），并引入具有遗忘门的长短时记忆单元（Long-Short Term Memory），作为处理序列输入输出的预测模型。

1. 搭建数据集并统计分析数据集中序列特征的分布。将数据集中的数据根据特征的分布平均划分为5个子集。为之后预测模型的5倍交叉验证做准备。2. 匹配数据集中的蛋白质序列和结构域序列，得到结构域在蛋白质全序列中的位置，并编码预测模型的目标输出值。3. 在整个数据集上对序列进行特征提取，并对序列中的每个氨基酸残基编码得到25维特征向量。4. 在搭建的数据集上测试DOMpro结构域预测模型，将其预测表现作为模型评价的参考。5. 建立双向长短时记忆神经网络预测模型的总体框架，并在数据集上进行训练。

    数据集上正负样本的分布不均衡，负样本超过95%，神经网络模型会倾向于将所有样本都预测为负样本。尽管最终生成模型的代价值小，但实际预测能力差。    解决思路有如下几种：1. 修正代价函数。对于正负样本不均衡的数据集，当前的代价函数不能很好的衡量模型的预测能力。考虑增大将正样本错误预测成负样本的代价，从而提高模型对于正样本的预测能力。应适当地选取代价权重值，若权重值过大，将会增大预测结果中假阳性的数量。2. 修正预测模型的结构，取局部序列而非全序列作为输入，并对样本进行采样以平衡样本分布。采样方式包括：(1) 对负样本进行欠采样。缺点是减少了样本数量，可能降低分类性能。(2) 对正样本进行过采样。缺点是复制正样本可能导致过拟合。

1. 在当前预测模型的总体框架下通过测试调整模型的参数和部分结构，以取得较优的预测能力。2. 对于模型的输出进行后处理，通过窗口平滑来减少假阳性结果，并选择合适的分类阈值。3. 选择适宜的评价标准，包括准确率、敏感度、特异度、规范化域重叠分数(NDO-score)、域边界距离分数(DBD-score) 等。4. 在数据集上测试其它的蛋白质结构域预测方法。5. 将建立的预测模型在数据集上做5倍交叉验证，并将测试结果与其它方法的结果比较，对模型的预测能力进行评价。